$ErrorActionPreference = "Stop";$url = 'https://cdn.immy.bot/immyagent-versions/0.58.1-pre.8?sv=2022-11-02&se=9999-12-31T23%3A59%3A59Z&sr=b&sp=r&sig=xVS8bKhjvuYw4ofPV68BonOqX%2B6rvJeW37CFtz4oP24%3D';$InstallerFile = [io.path]::ChangeExtension([io.path]::GetTempFileName(), ".msi");(New-Object System.Net.WebClient).DownloadFile($url, $InstallerFile);$InstallerLogFile = [io.path]::ChangeExtension([io.path]::GetTempFileName(), ".log");$Arguments = " /c msiexec /i `"$InstallerFile`" /qn /norestart /l*v `"$InstallerLogFile`" REBOOT=REALLYSUPPRESS ID=e8c8f207-8455-4a8b-9c3c-89b756eca5eb ADDR=https://britecity.immy.bot/plugins/api/v1/1 KEY=KB98NvqKdlomPSy0jUKfOt4OWzw3k8/AQUbUDpuhqFQ=";Write-Host "InstallerLogFile: $InstallerLogFile";$Process = Start-Process -Wait cmd -ArgumentList $Arguments -Passthru;if ($Process.ExitCode -ne 0) {    Get-Content $InstallerLogFile -ErrorAction SilentlyContinue | Select-Object -Last 200;    throw "Exit Code: $($Process.ExitCode), ComputerName: $($env:ComputerName)"}else {    Write-Host "Exit Code: $($Process.ExitCode)";    Write-Host "ComputerName: $($env:ComputerName)";}
